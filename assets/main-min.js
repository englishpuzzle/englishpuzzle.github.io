document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".grid-item"),t=document.getElementById("popup"),n=document.querySelector(".close-button"),o=document.getElementById("topic-title"),s=document.getElementById("words-list"),l=document.getElementById("new-translation"),a=document.getElementById("new-word");let c="",i=document.querySelector("#add-word-form");const r=document.getElementById("add-word-btn"),d=document.createElement("div");function u(e,t=5e3){const n=document.querySelector(".validation-message");n.textContent=e,n.classList.remove("hide"),n.classList.add("show"),setTimeout((()=>{n.classList.remove("show"),n.classList.add("hide"),setTimeout((()=>{n.textContent=""}),500)}),t)}function m(){const e=JSON.parse(localStorage.getItem("myWords")||"[]");e.length>0?topics["Мої слова"]=e:topics["Мої слова"]=[]}function p(e){let t=document.querySelector(".empty-vocabulary"),n=document.querySelector(".wrapper-global-button"),o=document.querySelector(".pagination");"show"===e?(t.style.display=" flex",n.style.display=" none",o.style.display=" none"):(t.style.display="none",n.style.display="flex",o.style.display="flex")}d.className="validation-message",document.getElementById("add-word-form").appendChild(d),m(),r.addEventListener("click",(function(){const e=a.value.trim(),t=l.value.trim();if(d.textContent="",!e||!t)return u("Обидва поля є обов’язковими!",3e3),void(d.style.color="#F44336");const n=JSON.parse(localStorage.getItem("myWords")||"[]");if(n.some((t=>t.word.toLowerCase()===e.toLowerCase())))return u("Слово вже існує!",5e3),void(d.style.color="#F44336");if(!/^[a-zA-Z-' ]+$/.test(e))return u("Слово має бути англійською мовою!",5e3),void(d.style.color="#F44336");if(e.length>20||t.length>20){return u("Максимальна довжина слова або перекладу не повинна перевищувати 20 символів",5e3),void(d.style.color="#F44336")}n.push({word:e,translation:t}),localStorage.setItem("myWords",JSON.stringify(n)),u("Слово успішно додано!",5e3),d.style.color="#4caf50",p("hide"),m(),f("Мої слова",page=1),a.value="",l.value=""}));const y=function(){const e=document.createElement("div"),t=document.createElement("button");return e.appendChild(t),t.classList.add("button"),e.classList.add("wrapper-global-button"),t.innerHTML='<i class="fas fa-eye-slash"></i>',t.onclick=h,t.style.display="block",t.style.padding="5px 34px",e}();function f(e,n=1){const l=6*(n-1),a=l+6,c=topics[e].slice(l,a);document.querySelector(".amount-number").innerHTML=`Всього: ${topics[e].length}`,o.innerText=e,s.innerHTML="",i.style.display="Мої слова"===e?"flex":"none",c.forEach((({word:t,translation:n})=>{const o=document.createElement("div");o.classList.add("word-item");const l=document.createElement("span");l.textContent=t,l.onclick="Мої слова"===e?()=>L(t):function(){const e=this.closest(".word-item").querySelector(".translation").textContent;!function(e,t){const n=document.querySelector(".additional-label"),o=JSON.parse(localStorage.getItem("myWords")||"[]"),s=o.some((t=>t.word.toLowerCase()===e.toLowerCase()));s?(n.textContent=`Слово "${e}" вже існує.`,n.style.background="#F44336"):(o.push({word:e,translation:t}),localStorage.setItem("myWords",JSON.stringify(o)),n.textContent=`Слово "${e}" успішно додано.`,n.style.background="#8BC34A");m(),setTimeout((()=>{n.textContent="",n.style.background="transparent"}),5e3)}(this.textContent,e)};const a=document.createElement("span");a.textContent=n,a.classList.add("blur","translation");const c=document.createElement("div");c.classList.add("buttons-wrapper");const i=document.createElement("button");i.classList.add("button","toggle-translation"),i.innerHTML='<i class="fas fa-eye-slash"></i>',i.onclick=()=>{const e=a.classList.contains("blur");a.classList.toggle("blur",!e),i.innerHTML=e?'<i class="fas fa-eye"></i>':'<i class="fas fa-eye-slash"></i>',function(){let e=document.querySelector(".wrapper-global-button button");const t=Array.from(document.querySelectorAll(".translation")).every((e=>e.classList.contains("blur"))),n=Array.from(document.querySelectorAll(".translation")).every((e=>!e.classList.contains("blur")));t?e.innerHTML='<i class="fas fa-eye-slash"></i>':n&&(e.innerHTML='<i class="fas fa-eye"></i>')}()};const r=document.createElement("button");r.classList.add("speak-button","button"),r.innerHTML='<i class="fas fa-volume-up"></i>',r.onclick=()=>function(e){const t=window.speechSynthesis;let n;function o(){const o=t.getVoices();n=o.find((e=>e.lang.includes("en")&&"male"===e.gender)),n||(n=o.find((e=>e.lang.includes("en"))));const s=new SpeechSynthesisUtterance(e);s.voice=n,t.speak(s)}0===t.getVoices().length?t.onvoiceschanged=o:o()}(t),o.appendChild(l),o.appendChild(a),o.appendChild(c),c.appendChild(i),c.appendChild(r),s.appendChild(o)}));const r=t.querySelector(".pagination");r&&r.remove();const d=function(e,t,n=1){const o=Math.ceil(e/t),s=document.createElement("div");s.className="pagination",g(s,n-1,"<",n>1),g(s,1,"1",1===n),n>3&&s.appendChild(document.createTextNode("... "));n>2&&g(s,n-1,n-1,!1);1!==n&&n!==o&&g(s,n,n,!0);n<o-1&&g(s,n+1,n+1,!1);n<o-2&&s.appendChild(document.createTextNode("... "));o>1&&g(s,o,o,n===o);return g(s,n+1,">",n<o),s}(topics[e].length,6,n);document.querySelector(".popup-content").appendChild(d),t.style.display="block"}function g(e,t,n,o){const s=document.createElement("a");s.innerText=n,o?(s.href="#",s.addEventListener("click",(e=>{e.preventDefault(),f(c,t)}))):s.classList.add("disabled"),e.appendChild(s)}function h(){let e=document.querySelector(".wrapper-global-button .button");console.log(e);const t=Array.from(document.querySelectorAll(".translation")).every((e=>e.classList.contains("blur")));document.querySelectorAll(".translation").forEach((e=>{e.classList.toggle("blur",!t)})),e.innerHTML=t?'<i class="fas fa-eye"></i>':'<i class="fas fa-eye-slash"></i>',document.querySelectorAll(".toggle-translation").forEach((e=>{e.innerHTML=t?'<i class="fas fa-eye"></i>':'<i class="fas fa-eye-slash"></i>'}))}function L(e){const t=document.getElementById("mini-popup"),n=document.getElementById("delete-word-confirm");t.querySelector(".mini-popup-content h2").textContent=e,n.setAttribute("data-word",e),t.classList.add("active"),n.onclick=function(e){let t=document.getElementById("mini-popup");const n=this.getAttribute("data-word"),o=JSON.parse(localStorage.getItem("myWords")||"[]").filter((e=>e.word.toLowerCase()!==n.toLowerCase()));localStorage.setItem("myWords",JSON.stringify(o)),m(),f("Мої слова",page=1),t.classList.remove("active")}}s.before(y),e.forEach((e=>{e.addEventListener("click",(function(){c=this.getAttribute("data-topic"),f(c),0===topics[c].length&&"Мої слова"===c&&p("show")}))})),n.addEventListener("click",(function(){t.style.display="none",p("hide")})),document.querySelector(".close-mini-popup").addEventListener("click",(function(){document.querySelector(".mini-popup").classList.remove("active")}))}));